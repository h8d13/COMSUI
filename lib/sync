#!/bin/bash

# Always check custom bin PATH set first. If not exit.
if ! echo "$PATH" | grep -q "$HOME/.local/bin"; then
    echo "0"
    exit 1
fi

# Only run sync if -s or -p is in arguments
if [[ "$*" == *"-s"* ]] || [[ "$*" == *"-p"* ]]; then
    case "$1" in
        "-s")
            # Remove existing comsui files if they exist
            rm -f "$HOME/.local/bin/comsui"
            rm -rf "$HOME/.local/bin/comsui-lib"

            # Copy executable directly to bin
            cp comsui "$HOME/.local/bin/"
            chmod +x "$HOME/.local/bin/comsui"

            # Create comsui-lib directory
            mkdir -p "$HOME/.local/bin/comsui-lib"
            cp lib/colors lib/sync "$HOME/.local/bin/comsui-lib/"

            echo "Synced comsui to ~/.local/bin/ as lib/"
            shift  # Remove -s from arguments
            ;;
        "-p")
            cp "$HOME/.local/bin/comsui" ./comsui
            cp "$HOME/.local/bin/comsui-lib/colors" "$HOME/.local/bin/comsui-lib/sync" lib/
            echo "Pulled comsui from ~/.local/bin/"
            shift  # Remove -p from arguments
            ;;
    esac
else
    echo "skipped"
fi
