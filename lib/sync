#!/bin/bash

# Always check custom bin PATH set first. If not exit.
if ! echo "$PATH" | grep -q "$HOME/.local/bin"; then
    echo "0"
    exit 1
fi

# Only run sync if -s or -p is in arguments
if [[ "$*" == *"-s"* ]] || [[ "$*" == *"-p"* ]]; then
    case "$1" in
        "-s")
            # Remove existing app files if they exist
            rm -f "$HOME/.local/bin/$APP"
            rm -rf "$HOME/.local/bin/${APP}-lib"

            # Copy executable directly to bin
            cp "$APP" "$HOME/.local/bin/"
            chmod +x "$HOME/.local/bin/$APP"

            # Create app-lib directory
            mkdir -p "$HOME/.local/bin/${APP}-lib"
            cp lib/colors lib/sync "$HOME/.local/bin/${APP}-lib/"

            echo "Synced $APP to ~/.local/bin/"
            shift  # Remove -s from arguments
            ;;
        "-p")
            cp "$HOME/.local/bin/$APP" ./"$APP"
            cp "$HOME/.local/bin/${APP}-lib/colors" "$HOME/.local/bin/${APP}-lib/sync" lib/
            echo "Pulled $APP from ~/.local/bin/"
            shift  # Remove -p from arguments
            ;;
    esac
else
    echo "skipped"
fi
