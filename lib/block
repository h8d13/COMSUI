#!/bin/bash

# Colors are already sourced by main script, no need to import again
# Block utility - run commands with colored output
block() {
    
    local color_func="info"
    # default if none specified
    local quiet=false
    # returns only code

    case "$1" in
        --info) color_func="info"; shift ;;
        --warn) color_func="warn"; shift ;;
        --gitop) color_func="gitop"; shift ;;
        --quiet) quiet=true; shift ;;
    esac

    # Show command being executed (unless quiet)
    if [[ "$quiet" != "true" ]]; then
        $color_func "$* ..."
    fi

    # Execute command and return exit code
    eval "$*"
    local exit_code=$?

    # Show result (unless quiet)
    if [[ "$quiet" != "true" ]]; then
        if [[ $exit_code -eq 0 ]]; then
            $color_func "Done"
        else
            warn "Failed"
        fi
    fi

    return $exit_code
}